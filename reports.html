<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>WareView — Reports</title>

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
  <link rel="stylesheet" href="styles.css">

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    /* Reports-specific styles (kept local to this page) */
    .reports-heatmap {
      background: #fff;
      padding: 18px;
      border-radius: 10px;
      box-shadow: 0 1px 2px rgba(15,23,42,0.04);
    }
    .heatmap-grid {
      display: grid;
      grid-template-columns: 50px repeat(7, 1fr);
      gap: 8px;
      align-items: center;
    }
    .heatmap-grid .time {
      color: var(--muted);
      font-size: 12px;
      text-align: right;
      padding-right: 8px;
    }
    .heatcell {
      height: 28px;
      border-radius: 6px;
      background: #eaf6ff; /* default light */
    }
    .heat-0 { background:#eaf6ff; }      /* 0-500 */
    .heat-1 { background:#bfeeff; }      /* 501-1000 */
    .heat-2 { background:#66ccff; }      /* 1001-5000 */
    .heat-3 { background:#0ea5ff; }      /* 5000+ (darker) */
    .heatmap-legend { display:flex;gap:10px;align-items:center;margin-top:14px;font-size:13px;color:var(--muted) }
    .heatmap-legend .key {display:inline-flex;align-items:center;gap:8px}
    .heat-swatch{width:28px;height:10px;border-radius:6px;display:inline-block}

    .reports-row {
      display:flex;
      gap:18px;
    }

    /* Supplier performance chart container */
    .supplier-performance {
      background:#fff;
      padding:18px;
      border-radius:10px;
      box-shadow: 0 1px 2px rgba(15,23,42,0.04);
      margin-top:18px;
    }

    /* Right column blocks */
    .right-block {
      background:#fff;
      padding:18px;
      border-radius:10px;
      box-shadow: 0 1px 2px rgba(15,23,42,0.04);
      margin-bottom:18px;
    }

    .reports-controls {
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:12px;
      margin-bottom:12px;
    }

    .btn-ghost {
      background:transparent;border:1px solid #e6eefb;padding:8px 12px;border-radius:8px;cursor:pointer;color:var(--blue)
    }

    .download-btn {
      background:linear-gradient(135deg,#3aa0ff,#7b61ff);color:#fff;border:0;padding:8px 12px;border-radius:8px;cursor:pointer;
    }

    /* Make sure chart canvases have a fixed height */
    #supplierPerfChart { height: 220px !important; }
    #suppliersPie { height: 180px !important; }

    /* page specific layout tweaks */
    .reports-top {
      display:flex;
      gap:18px;
      align-items:flex-start;
    }

    /* Legend for supplier performance */
    .perf-legend { display:flex;gap:12px;align-items:center;margin-top:10px;color:var(--muted) }
    .perf-legend .dot { width:10px;height:10px;border-radius:50%;display:inline-block }

    /* Responsive fallback */
    @media (max-width:1000px) {
      .reports-row, .reports-top { flex-direction:column }
    }
  </style>
</head>
<body>
  <div class="app">
    <!-- sidebar -->
    <aside class="sidebar" id="desktopSidebar" aria-hidden="false">
      <div class="logo">
        <span class="logo-black">Ware</span><span class="logo-blue">View</span>
      </div>

      <nav class="nav" aria-label="Main navigation">
        <h6 class="nav-section">GENERAL</h6>
        <ul>
          <li class="nav-item"><a href="index.html" class="nav-link"><i class="fa-solid fa-house"></i> Dashboard</a></li>
          <li class="nav-item"><a href="inventory.html" class="nav-link"><i class="fa-solid fa-box-open"></i> Inventory</a></li>
          <li class="nav-item"><a href="sales.html" class="nav-link"><i class="fa-solid fa-file-invoice-dollar"></i> Sales Orders</a></li>
          <li class="nav-item"><a href="suppliers.html" class="nav-link"><i class="fa-solid fa-handshake-simple"></i> Suppliers</a></li>
          <li class="nav-item"><a href="reports.html" class="nav-link active"><i class="fa-solid fa-chart-line"></i> Reports</a></li>
        </ul>

        <h6 class="nav-section">SUPPORT</h6>
        <ul>
          <li class="nav-item"><a href="#" class="nav-link"><i class="fa-solid fa-circle-question"></i> Help</a></li>
          <li class="nav-item"><a href="#" class="nav-link"><i class="fa-solid fa-gear"></i> Settings</a></li>
        </ul>
      </nav>
    </aside>

    <!-- main -->
    <div class="main">
      <header class="header">
        <div class="header-left">
          <div class="logo header-logo">
            <span class="logo-black">Ware</span><span class="logo-blue">View</span>
          </div>
        </div>

        <div class="header-right">
          <div class="search-wrap">
            <input id="reportsSearch" placeholder="Search" aria-label="Search reports" />
            <button class="search-btn" aria-label="Search"><i class="fa-solid fa-magnifying-glass"></i></button>
          </div>
          <button class="btn-ghost" style="margin-left:12px"><i class="fa-solid fa-print"></i> Print Reports</button>
        </div>
      </header>

      <section class="content">
        <h2 style="margin:10px 0 16px 0">Reports</h2>

        <!-- top area: heatmap (left) + right rail -->
        <div class="reports-top">
          <div style="flex:1">
            <div class="reports-heatmap">
              <div class="reports-controls">
                <div style="font-weight:600">Weekly Sales</div>
                <div style="color:var(--muted)">Aug 19 - 25</div>
              </div>

              <div class="heatmap-grid" id="heatmapGrid" aria-hidden="false">
                <!-- generated by JS -->
              </div>

              <div class="heatmap-legend">
                <div class="key"><span class="heat-swatch heat-0"></span> 0-500</div>
                <div class="key"><span class="heat-swatch heat-1"></span> 501-1,000</div>
                <div class="key"><span class="heat-swatch heat-2"></span> 1,001-5,000</div>
                <div class="key"><span class="heat-swatch heat-3"></span> 5,000+</div>
              </div>
            </div>

            <!-- supplier performance -->
            <div class="supplier-performance" style="margin-top:18px">
              <div style="display:flex;justify-content:space-between;align-items:center">
                <div style="font-weight:600">Supplier Performance Report <span style="color:var(--muted);font-weight:500;font-size:13px">(Top 5 Suppliers)</span></div>
                <div style="color:var(--muted);font-size:13px">Reports for Last Month</div>
              </div>

              <canvas id="supplierPerfChart" style="margin-top:14px"></canvas>

              <div class="perf-legend" aria-hidden="false">
                <div><span class="dot" style="background:#3aa0ff"></span> Early</div>
                <div><span class="dot" style="background:#ffd166"></span> On Time</div>
                <div><span class="dot" style="background:#ef3b83"></span> Late</div>
              </div>
            </div>
          </div>

          <!-- right column -->
          <div style="width:320px;display:flex;flex-direction:column">
            <div class="right-block">
              <div style="display:flex;justify-content:space-between;align-items:center">
                <div style="font-weight:600">Top Suppliers</div>
                <div style="color:var(--muted);font-size:13px">Aug</div>
              </div>
              <div style="width:220px;height:220px;margin:12px auto 4px">
                <canvas id="reportsSuppliersPie"></canvas>
              </div>
              <div id="reportsTopList" style="font-size:14px;color:var(--muted)"></div>
            </div>

            <div class="right-block" style="margin-top:8px;display:flex;flex-direction:column;gap:12px">
              <div>
                <div style="font-weight:600">Reports for Last Month</div>
                <div style="color:var(--muted);font-size:13px;margin-top:6px">From 01 Jul - 31 Jul</div>
                <div style="margin-top:10px;display:flex;gap:8px">
                  <button class="download-btn">Download PDF</button>
                  <a style="color:var(--muted);align-self:center;margin-left:8px">View</a>
                </div>
              </div>

              <div>
                <div style="font-weight:600">Defect Rate Report</div>
                <div style="color:var(--muted);font-size:13px;margin-top:6px">Product Defects & Supplier Origin</div>
                <div style="margin-top:10px;display:flex;gap:8px">
                  <button style="background:#7b61ff;color:#fff;border:0;padding:8px 12px;border-radius:8px">Download PDF</button>
                  <a style="color:var(--muted);align-self:center;margin-left:8px">View</a>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- footer -->
        <footer class="footer footer-desktop" style="margin-top:28px">
          <div class="footer-top">
            <div class="ft-left">
              <div class="logo small"><span class="logo-black">Ware</span><span class="logo-blue">View</span></div>
              <p class="tagline">Cultivating Efficiency, Tracking Excellence — Your Trusted Inventory Management Partner</p>
            </div>

            <div class="ft-center">
              <nav class="footer-nav">
                <a>Dashboard</a>
                <a>Sales</a>
                <a>Banking</a>
                <a>Records</a>
                <a>Contact Us</a>
              </nav>
            </div>

            <div class="ft-right">
              <div class="socials">
                <a class="social"><i class="fa-brands fa-facebook-f"></i></a>
                <a class="social"><i class="fa-brands fa-instagram"></i></a>
                <a class="social"><i class="fa-brands fa-twitter"></i></a>
              </div>
            </div>
          </div>

          <hr class="footer-divider" />

          <div class="footer-bottom">
            <div class="fb-left"><a>Privacy Policy</a></div>
            <div class="fb-center">© 2023 Mugna Technologies, Inc.</div>
            <div class="fb-right"><a>Terms & Conditions</a></div>
          </div>
        </footer>
      </section>
    </div>
  </div>

  <script>
    // Reports page JS (frontend-only sample data)
    document.addEventListener('DOMContentLoaded', function () {
      // --- Heatmap (Weekly Sales) ---
      const heatmapGrid = document.getElementById('heatmapGrid');
      const days = ['Mon','Tue','Wed','Thu','Fri','Sat','Sun'];
      const times = ['09:00','10:00','11:00','12:00','13:00','14:00','15:00','16:00'];

      // header row: empty cell + day labels
      const headerEmpty = document.createElement('div');
      headerEmpty.style.height = '1px';
      heatmapGrid.appendChild(headerEmpty);
      days.forEach(d => {
        const dd = document.createElement('div');
        dd.style.fontWeight = '600';
        dd.style.fontSize = '13px';
        dd.style.color = 'var(--muted)';
        dd.textContent = d;
        dd.style.textAlign = 'left';
        dd.style.paddingLeft = '6px';
        heatmapGrid.appendChild(dd);
      });

      // sample grid values (randomized for demo). You may replace with real data.
      const sampleValues = [];
      for (let r = 0; r < times.length; r++) {
        for (let c = 0; c < days.length; c++) {
          // random distribution skewed so some are high
          const pick = Math.floor(Math.random() * 14000);
          sampleValues.push(pick);
        }
      }

      function valueToClass(v) {
        if (v <= 500) return 'heat-0';
        if (v <= 1000) return 'heat-1';
        if (v <= 5000) return 'heat-2';
        return 'heat-3';
      }

      // build rows
      let idx = 0;
      times.forEach(t => {
        const timeCell = document.createElement('div');
        timeCell.className = 'time';
        timeCell.textContent = t.replace(':00','');
        heatmapGrid.appendChild(timeCell);

        for (let d=0; d<days.length; d++){
          const sv = sampleValues[idx++];
          const cell = document.createElement('div');
          cell.className = 'heatcell ' + valueToClass(sv);
          cell.title = sv.toLocaleString() + ' sales';
          heatmapGrid.appendChild(cell);
        }
      });

      // --- Supplier performance stacked horizontal bar (Chart.js) ---
      const perfCtx = document.getElementById('supplierPerfChart').getContext('2d');
      const suppliers = ['Apple','Samsung','Asus','Xiaomi','Logitech'];
      const early = [74,73,47,67,62];   // percents
      const ontime = [18,13,18,12,28];
      const late = [8,14,35,21,10];

      const perfChart = new Chart(perfCtx, {
        type: 'bar',
        data: {
          labels: suppliers,
          datasets: [
            { label: 'Early', data: early, backgroundColor: '#3aa0ff' },
            { label: 'On Time', data: ontime, backgroundColor: '#ffd166' },
            { label: 'Late', data: late, backgroundColor: '#ef3b83' }
          ]
        },
        options: {
          indexAxis: 'y',
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { display: false }
          },
          scales: {
            x: {
              stacked: true,
              ticks: { callback: v => v + '%' },
              grid: { display: false }
            },
            y: { stacked: true }
          }
        }
      });

      // show percent values inside bars (simple overlay using plugin)
      Chart.register({
        id: 'barLabels',
        afterDatasetsDraw: function(chart) {
          const ctx = chart.ctx;
          chart.data.datasets.forEach((dataset, i) => {
            const meta = chart.getDatasetMeta(i);
            meta.data.forEach((bar, idx) => {
              const val = dataset.data[idx];
              if (val === 0) return;
              const centerX = bar.x + bar.width / 2;
              const centerY = bar.y;
              ctx.save();
              ctx.fillStyle = '#fff';
              ctx.font = '12px Inter, Arial';
              ctx.textAlign = 'center';
              ctx.textBaseline = 'middle';
              // place the text inside the stacked portion if enough width
              const w = bar.width;
              if (w > 30) ctx.fillText(val + '%', bar.x + w/2, bar.y);
              ctx.restore();
            });
          });
        }
      });

      // re-create chart with plugin to draw labels
      perfChart.options.plugins.barLabels = true;
      perfChart.update();

      // --- Top suppliers pie chart ---
      const pieCtx = document.getElementById('reportsSuppliersPie').getContext('2d');
      const pieLabels = ['Apple','Samsung','Asus','Xiaomi'];
      const pieData = [61,15,13,8];
      const pieColors = ['#3aa0ff','#ef3b83','#59c24a','#7b61ff'];
      const pie = new Chart(pieCtx, {
        type: 'doughnut',
        data: {
          labels: pieLabels,
          datasets: [{ data: pieData, backgroundColor: pieColors }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: { legend: { display: false } }
        }
      });

      // populate right-side top list
      const topList = document.getElementById('reportsTopList');
      if (topList) {
        topList.innerHTML = '';
        pieLabels.forEach((lab, i) => {
          const wrap = document.createElement('div');
          wrap.style.display = 'flex';
          wrap.style.justifyContent = 'space-between';
          wrap.style.padding = '6px 0';
          wrap.innerHTML = `<div style="display:flex;gap:8px;align-items:center"><span style="display:inline-block;width:10px;height:10px;border-radius:50%;background:${pieColors[i]};"></span><div>${lab}</div></div><div style="font-weight:700;color:${pieColors[i]}">${pieData[i]}%</div>`;
          topList.appendChild(wrap);
        });
      }

      // small accessibility: keyboard focus for "Print Reports" is handled by browser
    });
  </script>
</body>
</html>